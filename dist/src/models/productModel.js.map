<<<<<<< HEAD
{"version":3,"file":"productModel.js","sourceRoot":"","sources":["../../../src/models/productModel.ts"],"names":[],"mappings":"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","sourcesContent":["import DbClient = require(\"../DbClient\");\r\n\r\nexport class ProductModel {\r\n\r\n    constructor() {}\r\n    /*\r\n        input type: key value arr, example :  [{\"1\":300}, {\"3\":400},{\"5\":500}]\r\n        returns an array of shoe objects ex: [ {shoe_1 ...}, {shoe_2 ...}, {shoe_3}...]\r\n     */\r\n    public getAllShoes(shoeKeysVal: any) {\r\n\r\n        const keyArr: any[] = [];\r\n\r\n        // get the keys from the input, keys_arr should be equal to [1,3,5] from the example above\r\n\r\n        let prop;\r\n        for (prop of shoeKeysVal) {\r\n            keyArr.push(JSON.parse(JSON.stringify(prop)).shoe_id);\r\n        }\r\n\r\n        // an array of objects holding indvidual json objects for each of the shoes the user has\r\n        const jsonShoeArr: any[] = [];\r\n\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n                // will return all the shoes in db\r\n                return db!.collection(\"shoes\").find().toArray();\r\n            })\r\n            .then((sneakers: any) => {\r\n                // loop over all the shoes in db and push into jsonShoeArr only those that are\r\n                // owned by user\r\n                let shoe;\r\n                let id;\r\n                for (shoe of sneakers ) {\r\n                    for (id of keyArr) {\r\n                        // if current shoe is also a shoe owned by user, id is type string so we typecast to number\r\n                        if (shoe.shoe_id === Number(id)) {\r\n                            jsonShoeArr.push(shoe);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return jsonShoeArr;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    /*\r\n     Input type: integer that refers to the shoe_id. ex: 3\r\n     Output type: a json shoe obejct ex: {shoe_id:3 ... }\r\n     */\r\n\r\n    public getOneShoe(shoeID: any) {\r\n\r\n        console.log(shoeID);\r\n        // an array of objects holding indvidual json objects for each of the shoes the user has\r\n        const jsonShoeArr: any[] = [];\r\n\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n\r\n                // will return all the shoes in db\r\n                return db!.collection(\"shoes\").find().toArray();\r\n\r\n            })\r\n\r\n            .then((sneakers: any) => {\r\n\r\n                // loop over all the shoes in db and push into jsonShoeArr only the shoe that has id\r\n                // shoeID\r\n                let shoe;\r\n                for ( shoe of sneakers ) {\r\n                    // if current shoe is also a shoe whose id is shoeID, shoeID is type string so we typecast to number\r\n                    if (shoe.shoe_id === Number(shoeID)) {\r\n                        jsonShoeArr.push(shoe);\r\n                        break;\r\n                    }\r\n                }\r\n                return jsonShoeArr[0];\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    /*\r\n            Return all the shoes for the view where we need to see all shoes available in db\r\n     */\r\n\r\n    public updateShoes(priceChange: any) {\r\n        const shoeUpdate = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").updateMany({}, { $inc: { current_price: priceChange }});\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"failed to update shoes\");\r\n                return false;\r\n            });\r\n        return shoeUpdate;\r\n    }\r\n\r\n    public getAllDB() {\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n                return db!.collection(\"shoes\").find().toArray();\r\n            })\r\n            .then((sneakers: any) => {\r\n                return sneakers;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    public add_shoe(model:any, shoe_id:any, size:any, cp:any, rp:any,brand:any,colorway:any) {\r\n        const add_shoes = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").insertOne({ size:size, brand:brand, colorway:colorway, shoe_id:shoe_id,model:model,current_price: cp, retail_price:rp});\r\n                console.log(\"adding shoe\");\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return add_shoes;\r\n    }\r\n\r\n\r\n    public edit_shoe(model:any, shoe_id:any, size:any, cp:any, rp:any,brand:any,colorway:any) {\r\n        const result = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").updateOne({shoe_id: shoe_id},\r\n                    {$set: {brand:brand, colorway:colorway,model:model,current_price: cp, retail_price:rp}});\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return result;\r\n    }\r\n\r\n    public remove_shoe(shoeId: any) {\r\n        const remove_user = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").deleteOne({ shoe_id: shoeId});\r\n                db!.collection(\"user_shoes\").deleteMany({ shoe_id: shoeId});\r\n                db!.collection(\"notifications\").deleteMany({ shoe_id: shoeId});\r\n                db!.collection(\"users\").deleteMany({ shoe_id: null});\r\n\r\n                console.log(\"deleted shoe\");\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return remove_user;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n"]}
=======
{"version":3,"file":"productModel.js","sourceRoot":"","sources":["../../../src/models/productModel.ts"],"names":[],"mappings":";;AAAA,sCAAyC;AAEzC;IAEI;IAAe,CAAC;IAChB;;;OAGG;IACI,kCAAW,GAAlB,UAAmB,WAAgB;QAE/B,IAAM,MAAM,GAAU,EAAE,CAAC;QAEzB,0FAA0F;QAE1F,IAAI,IAAI,CAAC;QACT,KAAa,UAAW,EAAX,2BAAW,EAAX,yBAAW,EAAX,IAAW,EAAE;YAArB,IAAI,oBAAA;YACL,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;SACzD;QAED,wFAAwF;QACxF,IAAM,WAAW,GAAU,EAAE,CAAC;QAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,EAAE;aAC3B,IAAI,CAAC,UAAC,EAAE;YACL,kCAAkC;YAClC,OAAO,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACpD,CAAC,CAAC;aACD,IAAI,CAAC,UAAC,QAAa;YAChB,8EAA8E;YAC9E,gBAAgB;YAChB,IAAI,IAAI,CAAC;YACT,IAAI,EAAE,CAAC;YACP,KAAa,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAG;gBAAnB,IAAI,iBAAA;gBACL,KAAW,UAAM,EAAN,iBAAM,EAAN,oBAAM,EAAN,IAAM,EAAE;oBAAd,EAAE,eAAA;oBACH,2FAA2F;oBAC3F,IAAI,IAAI,CAAC,OAAO,KAAK,MAAM,CAAC,EAAE,CAAC,EAAE;wBAC7B,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACvB,MAAM;qBACT;iBACJ;aACJ;YACD,OAAO,WAAW,CAAC;QACvB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEP,OAAO,KAAK,CAAC;IACjB,CAAC;IAED;;;OAGG;IAEI,iCAAU,GAAjB,UAAkB,MAAW;QAEzB,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QACpB,wFAAwF;QACxF,IAAM,WAAW,GAAU,EAAE,CAAC;QAE9B,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,EAAE;aAC3B,IAAI,CAAC,UAAC,EAAE;YAEL,kCAAkC;YAClC,OAAO,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QAEpD,CAAC,CAAC;aAED,IAAI,CAAC,UAAC,QAAa;YAEhB,oFAAoF;YACpF,SAAS;YACT,IAAI,IAAI,CAAC;YACT,KAAc,UAAQ,EAAR,qBAAQ,EAAR,sBAAQ,EAAR,IAAQ,EAAG;gBAAnB,IAAI,iBAAA;gBACN,oGAAoG;gBACpG,IAAI,IAAI,CAAC,OAAO,KAAK,MAAM,CAAC,MAAM,CAAC,EAAE;oBACjC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACvB,MAAM;iBACT;aACJ;YACD,OAAO,WAAW,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEP,OAAO,KAAK,CAAC;IACjB,CAAC;IAED;;OAEG;IAEI,kCAAW,GAAlB,UAAmB,WAAgB;QAC/B,IAAM,UAAU,GAAG,QAAQ,CAAC,OAAO,EAAE;aAChC,IAAI,CAAC,UAAC,EAAE;YACL,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,EAAE,aAAa,EAAE,WAAW,EAAE,EAAC,CAAC,CAAC;YAChF,OAAO,IAAI,CAAC;QAChB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;YACtC,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC,CAAC;QACP,OAAO,UAAU,CAAC;IACtB,CAAC;IAEM,+BAAQ,GAAf;QACI,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,EAAE;aAC3B,IAAI,CAAC,UAAC,EAAE;YACL,OAAO,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;QACpD,CAAC,CAAC;aACD,IAAI,CAAC,UAAC,QAAa;YAChB,OAAO,QAAQ,CAAC;QACpB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEP,OAAO,KAAK,CAAC;IACjB,CAAC;IAEM,+BAAQ,GAAf,UAAgB,KAAS,EAAE,OAAW,EAAE,IAAQ,EAAE,EAAM,EAAE,EAAM,EAAC,KAAS,EAAC,QAAY;QACnF,IAAM,SAAS,GAAG,QAAQ,CAAC,OAAO,EAAE;aAC/B,IAAI,CAAC,UAAC,EAAE;YACL,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,EAAE,KAAK,EAAC,KAAK,EAAE,QAAQ,EAAC,QAAQ,EAAE,OAAO,EAAC,OAAO,EAAC,KAAK,EAAC,KAAK,EAAC,aAAa,EAAE,EAAE,EAAE,YAAY,EAAC,EAAE,EAAC,CAAC,CAAC;YACrI,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3B,OAAO,IAAI,CAAC;QAChB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3B,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC,CAAC;QACP,OAAO,SAAS,CAAC;IACrB,CAAC;IAGM,gCAAS,GAAhB,UAAiB,KAAS,EAAE,OAAW,EAAE,IAAQ,EAAE,EAAM,EAAE,EAAM,EAAC,KAAS,EAAC,QAAY;QACpF,IAAM,MAAM,GAAG,QAAQ,CAAC,OAAO,EAAE;aAC5B,IAAI,CAAC,UAAC,EAAE;YACL,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,EAAC,OAAO,EAAE,OAAO,EAAC,EAChD,EAAC,IAAI,EAAE,EAAC,KAAK,EAAC,KAAK,EAAE,QAAQ,EAAC,QAAQ,EAAC,KAAK,EAAC,KAAK,EAAC,aAAa,EAAE,EAAE,EAAE,YAAY,EAAC,EAAE,EAAC,EAAC,CAAC,CAAC;YAC7F,OAAO,IAAI,CAAC;QAChB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3B,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC,CAAC;QACP,OAAO,MAAM,CAAC;IAClB,CAAC;IAEM,kCAAW,GAAlB,UAAmB,MAAW;QAC1B,IAAM,WAAW,GAAG,QAAQ,CAAC,OAAO,EAAE;aACjC,IAAI,CAAC,UAAC,EAAE;YACL,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,SAAS,CAAC,EAAE,OAAO,EAAE,MAAM,EAAC,CAAC,CAAC;YACtD,EAAG,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE,MAAM,EAAC,CAAC,CAAC;YAC5D,EAAG,CAAC,UAAU,CAAC,eAAe,CAAC,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE,MAAM,EAAC,CAAC,CAAC;YAC/D,EAAG,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,UAAU,CAAC,EAAE,OAAO,EAAE,IAAI,EAAC,CAAC,CAAC;YAErD,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YAC5B,OAAO,IAAI,CAAC;QAChB,CAAC,CAAC;aACD,KAAK,CAAC,UAAC,GAAG;YACP,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAC3B,OAAO,KAAK,CAAC;QACjB,CAAC,CAAC,CAAC;QACP,OAAO,WAAW,CAAC;IACvB,CAAC;IAQL,mBAAC;AAAD,CAAC,AA9KD,IA8KC;AA9KY,oCAAY","sourcesContent":["import DbClient = require(\"../DbClient\");\r\n\r\nexport class ProductModel {\r\n\r\n    constructor() {}\r\n    /*\r\n        input type: key value arr, example :  [{\"1\":300}, {\"3\":400},{\"5\":500}]\r\n        returns an array of shoe objects ex: [ {shoe_1 ...}, {shoe_2 ...}, {shoe_3}...]\r\n     */\r\n    public getAllShoes(shoeKeysVal: any) {\r\n\r\n        const keyArr: any[] = [];\r\n\r\n        // get the keys from the input, keys_arr should be equal to [1,3,5] from the example above\r\n\r\n        let prop;\r\n        for (prop of shoeKeysVal) {\r\n            keyArr.push(JSON.parse(JSON.stringify(prop)).shoe_id);\r\n        }\r\n\r\n        // an array of objects holding indvidual json objects for each of the shoes the user has\r\n        const jsonShoeArr: any[] = [];\r\n\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n                // will return all the shoes in db\r\n                return db!.collection(\"shoes\").find().toArray();\r\n            })\r\n            .then((sneakers: any) => {\r\n                // loop over all the shoes in db and push into jsonShoeArr only those that are\r\n                // owned by user\r\n                let shoe;\r\n                let id;\r\n                for (shoe of sneakers ) {\r\n                    for (id of keyArr) {\r\n                        // if current shoe is also a shoe owned by user, id is type string so we typecast to number\r\n                        if (shoe.shoe_id === Number(id)) {\r\n                            jsonShoeArr.push(shoe);\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return jsonShoeArr;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    /*\r\n     Input type: integer that refers to the shoe_id. ex: 3\r\n     Output type: a json shoe obejct ex: {shoe_id:3 ... }\r\n     */\r\n\r\n    public getOneShoe(shoeID: any) {\r\n\r\n        console.log(shoeID);\r\n        // an array of objects holding indvidual json objects for each of the shoes the user has\r\n        const jsonShoeArr: any[] = [];\r\n\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n\r\n                // will return all the shoes in db\r\n                return db!.collection(\"shoes\").find().toArray();\r\n\r\n            })\r\n\r\n            .then((sneakers: any) => {\r\n\r\n                // loop over all the shoes in db and push into jsonShoeArr only the shoe that has id\r\n                // shoeID\r\n                let shoe;\r\n                for ( shoe of sneakers ) {\r\n                    // if current shoe is also a shoe whose id is shoeID, shoeID is type string so we typecast to number\r\n                    if (shoe.shoe_id === Number(shoeID)) {\r\n                        jsonShoeArr.push(shoe);\r\n                        break;\r\n                    }\r\n                }\r\n                return jsonShoeArr[0];\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    /*\r\n            Return all the shoes for the view where we need to see all shoes available in db\r\n     */\r\n\r\n    public updateShoes(priceChange: any) {\r\n        const shoeUpdate = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").updateMany({}, { $inc: { current_price: priceChange }});\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"failed to update shoes\");\r\n                return false;\r\n            });\r\n        return shoeUpdate;\r\n    }\r\n\r\n    public getAllDB() {\r\n        const shoes = DbClient.connect()\r\n            .then((db) => {\r\n                return db!.collection(\"shoes\").find().toArray();\r\n            })\r\n            .then((sneakers: any) => {\r\n                return sneakers;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n            });\r\n\r\n        return shoes;\r\n    }\r\n\r\n    public add_shoe(model:any, shoe_id:any, size:any, cp:any, rp:any,brand:any,colorway:any) {\r\n        const add_shoes = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").insertOne({ brand:brand, colorway:colorway, shoe_id:shoe_id,model:model,current_price: cp, retail_price:rp});\r\n                console.log(\"adding shoe\");\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return add_shoes;\r\n    }\r\n\r\n\r\n    public edit_shoe(model:any, shoe_id:any, size:any, cp:any, rp:any,brand:any,colorway:any) {\r\n        const result = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").updateOne({shoe_id: shoe_id},\r\n                    {$set: {brand:brand, colorway:colorway,model:model,current_price: cp, retail_price:rp}});\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return result;\r\n    }\r\n\r\n    public remove_shoe(shoeId: any) {\r\n        const remove_user = DbClient.connect()\r\n            .then((db) => {\r\n                db!.collection(\"shoes\").deleteOne({ shoe_id: shoeId});\r\n                db!.collection(\"user_shoes\").deleteMany({ shoe_id: shoeId});\r\n                db!.collection(\"notifications\").deleteMany({ shoe_id: shoeId});\r\n                db!.collection(\"users\").deleteMany({ shoe_id: null});\r\n\r\n                console.log(\"deleted shoe\");\r\n                return true;\r\n            })\r\n            .catch((err) => {\r\n                console.log(\"err.message\");\r\n                return false;\r\n            });\r\n        return remove_user;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n}\r\n"]}
>>>>>>> bbdfc09265232636b1c30cf0b42472866f13c2ba
