{"version":3,"file":"productController.js","sourceRoot":"","sources":["../../../src/controllers/productController.ts"],"names":[],"mappings":"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","sourcesContent":["import { NextFunction, Request, Response, Router} from \"express\";\nimport Helpers = require(\"../helperFunctions\");\nimport { ProductModel } from \"../models/productModel\";\nimport { BaseRoute } from \"../routes/router\";\n\nexport class ProductController extends BaseRoute {\n\n    public static create(router: Router) {\n        // show all shoes\n        router.get(\"/user/:id/allShoes\", (req: Request, res: Response, next: NextFunction) => {\n            new ProductController().allShoes(req, res, next);\n        });\n        // show all shoes sorted from high to low\n        router.get(\"/user/:id/allShoes/sort/price_high\", (req: Request, res: Response, next: NextFunction) => {\n            new ProductController().sortPriceHighDb(req, res, next);\n        });\n        // show all shoes sorted from low to high\n        router.get(\"/user/:id/allShoes/sort/price_low\", (req: Request, res: Response, next: NextFunction) => {\n            new ProductController().sortPriceLowDb(req, res, next);\n        });\n        // Add shoe (id2) to user (id) portfolio, redirect to price input\n        router.get(\"/user/:id/add_shoe/:id2\", (req: Request, res: Response, next: NextFunction) => {\n            new ProductController().inputShoe(req, res, next);\n        });\n    }\n\n    public async inputShoe(req: Request, res: Response, next: NextFunction) {\n        const userIdString = \"id\";\n        const userId = parseInt(req.params[userIdString], 10);\n        const shoeIdString = \"id2\";\n        const shoeId = parseInt(req.params[shoeIdString], 10);\n        const shoe = await Helpers.getShoe(shoeId);\n        if (shoe) {\n            this.render(req, res, \"addShoe\", {id: userId, shoe});\n        } else {\n            res.status(404)\n                .send({\n                    message: \"No shoe found with the given id.\",\n                    status: res.status,\n                });\n        }\n\n    }\n\n    // get all the shoes from the db and render to shoesList view\n    public async allShoes(req: Request, res: Response, next: NextFunction) {\n        const idString = \"id\";\n        const userId = parseInt(req.params[idString], 10);\n        if (await Helpers.isUser(userId)) {\n            const shoeIf = new ProductModel();\n            const allShoes = await shoeIf.getAllDB();\n            this.render(req, res, \"shoeList\", {id: userId, title: \"Shoes\", data: allShoes});\n        } else {\n            res.status(404)\n                .send({\n                    message: \"No user found with the given user id.\",\n                    status: res.status,\n                });\n        }\n    }\n\n    public async sortPriceLowDb(req: Request, res: Response, next: NextFunction) {\n        const idString = \"id\";\n        const queryint = parseInt(req.params[idString], 10);\n        if (await Helpers.isUser(queryint)) {\n            const shoeIf = new ProductModel();\n            const allShoes = await shoeIf.getAllDB();\n            const sortedShoes: any = allShoes;\n            sortedShoes.sort((a: any, b: any) => a.current_price - b.current_price);\n            this.render(req, res, \"shoeList\", {\n                data: sortedShoes,\n                id: queryint,\n                title: \"Shoes\",\n            });\n        } else {\n            res.status(404);\n            res.send(\"invalid user\");\n        }\n    }\n\n    public async sortPriceHighDb(req: Request, res: Response, next: NextFunction) {\n        const idString = \"id\";\n        const queryint = parseInt(req.params[idString], 10);\n        if (await Helpers.isUser(queryint)) {\n            const shoeIf = new ProductModel();\n            const allShoes = await shoeIf.getAllDB();\n            const sortedShoes: any = allShoes;\n            sortedShoes.sort((a: any, b: any) => b.current_price - a.current_price);\n            this.render(req, res, \"shoeList\", {\n                data: sortedShoes,\n                id: queryint,\n                title: \"Shoes\",\n            });\n        } else {\n            res.status(404);\n            res.send(\"invalid user\");\n        }\n    }\n\n}\n"]}