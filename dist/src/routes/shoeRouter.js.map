{"version":3,"file":"shoeRouter.js","sourceRoot":"","sources":["../../../src/routes/shoeRouter.ts"],"names":[],"mappings":"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","sourcesContent":["import { NextFunction, Request, Response, Router} from \"express\";\nimport Shoes = require(\"../../dist/data.json\");\nimport { BaseRoute } from \"./router\";\n\nexport class ShoeRouter extends BaseRoute {\n    public static create(router: Router) {\n        // log\n        console.log(\"[ShoeRoute::create] Creating ShoeRoutes route.\");\n\n        // add home page route\n        router.get(\"/api/shoes\", (req: Request, res: Response, next: NextFunction) => {\n            new ShoeRouter().getAll(req, res, next);\n        });\n\n        // add getOne route\n        router.get(\"/api/shoes/:id\", (req: Request, res: Response, next: NextFunction) => {\n            new ShoeRouter().getOne(req, res, next);\n        });\n\n        router.get(\"/api/sortpricelow\", (req: Request, res: Response, next: NextFunction) => {\n            new ShoeRouter().sortPriceLow(req, res, next);\n        });\n\n        router.get(\"/api/sortpricehigh\", (req: Request, res: Response, next: NextFunction) => {\n            new ShoeRouter().sortPriceHigh(req, res, next);\n        });\n    }\n\n    // constructor() {\n        // not much here yet\n    // }\n\n    public sortPriceLow(req: Request, res: Response, next: NextFunction) {\n        const shoes: any[] = [];\n        Shoes.forEach((element: any) => {\n            shoes.push(JSON.parse(JSON.stringify(element)));\n        });\n        shoes.sort((a, b) => a.current_price - b.current_price);\n        console.log(shoes);\n        this.render(req, res, \"allShoes\", {title: \"Shoes\", data: shoes});\n\n    }\n\n    public sortPriceHigh(req: Request, res: Response, next: NextFunction) {\n        const shoes: any[] = [];\n        Shoes.forEach((element: any) => {\n            shoes.push(JSON.parse(JSON.stringify(element)));\n        });\n        shoes.sort((a, b) => b.current_price - a.current_price);\n        console.log(shoes);\n        this.render(req, res, \"allShoes\", {title: \"Shoes\", data: shoes});\n\n    }\n\n    /**\n     * GET all Shoes.\n     */\n    public getAll(req: Request, res: Response, next: NextFunction) {\n        /* DbClient.connect()\n            .then((db) => {\n                return db!.collection(\"sneakers\").find().toArray();\n            })\n            .then((sneakers:any) => {\n                console.log(sneakers);\n                res.send(sneakers);\n            })\n            .catch((err) => {\n                console.log(\"err.message\");\n            }) */\n            // res.send(Shoes);\n            const shoeArray: any[] = [];\n            Shoes.forEach((element: any) => {\n                shoeArray.push(JSON.parse(JSON.stringify(element)));\n            });\n            console.log(shoeArray);\n            this.render(req, res, \"allShoes\", {title: \"Shoes\", data: shoeArray});\n    }\n\n    /**\n     * GET one shoe by id\n     */\n    public getOne(req: Request, res: Response, next: NextFunction) {\n        const idString = \"id\";\n        const queryint = parseInt(req.params[idString], 10);\n        let shoe: any = Shoes[1];\n        for (const item in Shoes) {\n            if (Shoes.hasOwnProperty(item)) {\n                const shoeid: number = Shoes[item].id;\n                if (shoeid === queryint) {\n                    shoe = Shoes[item];\n                }\n            }\n        }\n        if (shoe) {\n            const diff = \"diff\";\n            shoe[diff] = shoe.current_price - shoe.retail_price;\n            this.render(req, res, \"oneShoe\", shoe);\n            /* res.status(200)\n                .send({\n                    message: 'Success',\n                    status: res.status,\n                    shoe\n                }); */\n        } else {\n            res.status(404)\n                .send({\n                    message: \"No shoe found with the given id.\",\n                    status: res.status,\n                });\n        }\n\n    }\n\n}\n"]}